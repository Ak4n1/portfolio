import{a as E}from"./chunk-RN22FLO7.js";import{a as I}from"./chunk-33UCSS4H.js";import{c as k,d as l,e as R,f as N,k as T,m as D,n as z,u as q,w as A}from"./chunk-SBYHMJI5.js";import{f as O,g as S}from"./chunk-3STYZOIF.js";import"./chunk-DW4U6NCB.js";import"./chunk-WY3MPDUA.js";import{k as v,s as b}from"./chunk-RKUWSNO2.js";import{Ab as p,Ib as u,Jb as M,Rb as s,Sb as F,Ua as n,Za as x,_ as f,cb as h,hb as d,ob as C,pb as m,ra as y,rb as c,sb as _,t as P,yb as i,zb as r}from"./chunk-VJKI3SXJ.js";function Y(a,e){a&1&&(i(0,"span",23),s(1,"M\xEDnimo 2 caracteres"),r())}function H(a,e){a&1&&(i(0,"span",23),s(1,"M\xEDnimo 2 caracteres"),r())}function J(a,e){a&1&&(i(0,"span",23),s(1,"Email v\xE1lido requerido"),r())}function K(a,e){a&1&&(i(0,"span",23),s(1,"M\xEDnimo 6 caracteres"),r())}function Q(a,e){a&1&&(i(0,"span",23),s(1,"Las contrase\xF1as no coinciden"),r())}var w=class a{constructor(e){this.fb=e;this.form=this.fb.group({name:["",[l.required,l.minLength(2)]],apellido:["",[l.required,l.minLength(2)]],email:["",[l.required,l.email]],password:["",[l.required,l.minLength(6)]],confirmPassword:["",[l.required]]},{validators:this.passwordMatchValidator})}submitForm=y();form;passwordMatchValidator(e){let o=e.get("password")?.value,t=e.get("confirmPassword")?.value;return o===t?null:{mismatch:!0}}isFieldInvalid(e){let o=this.form.get(e);return!!o&&o.invalid&&(o.dirty||o.touched)}isConfirmPasswordInvalid(){let e=this.form.get("confirmPassword");return!!e&&this.form.hasError("mismatch")&&(e?.dirty||e?.touched)}showPassword=!1;showConfirmPassword=!1;togglePassword(){this.showPassword=!this.showPassword}toggleConfirmPassword(){this.showConfirmPassword=!this.showConfirmPassword}onSubmit(){if(this.form.valid){let{name:e,apellido:o,email:t,password:g}=this.form.value;this.submitForm.emit({name:e,apellido:o,email:t,password:g})}else Object.keys(this.form.controls).forEach(e=>this.form.get(e)?.markAsTouched())}static \u0275fac=function(o){return new(o||a)(x(q))};static \u0275cmp=h({type:a,selectors:[["app-register-form"]],outputs:{submitForm:"submitForm"},decls:43,vars:25,consts:[[1,"auth-form"],[1,"auth-title"],[1,"auth-subtitle"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","register-name"],["id","register-name","type","text","formControlName","name","placeholder","Tu nombre"],["class","error-msg",4,"ngIf"],["for","register-apellido"],["id","register-apellido","type","text","formControlName","apellido","placeholder","Tu apellido"],["for","register-email"],["id","register-email","type","email","formControlName","email","placeholder","tu@email.com"],["for","register-password"],[1,"password-input-wrapper"],["id","register-password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"password-input-field",3,"type"],["type","button",1,"password-toggle",3,"click"],["aria-hidden","true"],["for","register-confirm"],["id","register-confirm","formControlName","confirmPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"password-input-field",3,"type"],[1,"auth-actions"],["routerLink","/login",1,"btn-cancel"],["type","submit",1,"btn-submit",3,"disabled"],[1,"error-msg"]],template:function(o,t){o&1&&(i(0,"div",0)(1,"h2",1),s(2,"Registrarse"),r(),i(3,"p",2),s(4,"Completa el formulario para registrarte"),r(),i(5,"form",3),u("ngSubmit",function(){return t.onSubmit()}),i(6,"div",4)(7,"div",5)(8,"label",6),s(9,"Nombre"),r(),p(10,"input",7),d(11,Y,2,0,"span",8),r(),i(12,"div",5)(13,"label",9),s(14,"Apellido"),r(),p(15,"input",10),d(16,H,2,0,"span",8),r()(),i(17,"div",5)(18,"label",11),s(19,"Email"),r(),p(20,"input",12),d(21,J,2,0,"span",8),r(),i(22,"div",5)(23,"label",13),s(24,"Contrase\xF1a"),r(),i(25,"div",14),p(26,"input",15),i(27,"button",16),u("click",function(){return t.togglePassword()}),p(28,"i",17),r()(),d(29,K,2,0,"span",8),r(),i(30,"div",5)(31,"label",18),s(32,"Confirmar contrase\xF1a"),r(),i(33,"div",14),p(34,"input",19),i(35,"button",16),u("click",function(){return t.toggleConfirmPassword()}),p(36,"i",17),r()(),d(37,Q,2,0,"span",8),r(),i(38,"div",20)(39,"a",21),s(40,"Ya tengo cuenta"),r(),i(41,"button",22),s(42,"Registrarse"),r()()()()),o&2&&(n(5),m("formGroup",t.form),n(5),c("error",t.isFieldInvalid("name")),n(),m("ngIf",t.isFieldInvalid("name")),n(4),c("error",t.isFieldInvalid("apellido")),n(),m("ngIf",t.isFieldInvalid("apellido")),n(4),c("error",t.isFieldInvalid("email")),n(),m("ngIf",t.isFieldInvalid("email")),n(5),c("error",t.isFieldInvalid("password")),m("type",t.showPassword?"text":"password"),n(),C("aria-label",t.showPassword?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),n(),_(t.showPassword?"fas fa-eye":"fas fa-eye-slash"),n(),m("ngIf",t.isFieldInvalid("password")),n(5),c("error",t.isConfirmPasswordInvalid()),m("type",t.showConfirmPassword?"text":"password"),n(),C("aria-label",t.showConfirmPassword?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),n(),_(t.showConfirmPassword?"fas fa-eye":"fas fa-eye-slash"),n(),m("ngIf",t.isConfirmPasswordInvalid()),n(4),m("disabled",t.form.invalid))},dependencies:[A,T,k,R,N,D,z,b,v,S],styles:[".auth-form[_ngcontent-%COMP%]{padding:.5rem}.auth-title[_ngcontent-%COMP%]{color:var(--title-primary);font-size:1.5rem;margin-bottom:.5rem;text-align:center}.auth-subtitle[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.9rem;text-align:center;margin-bottom:1.25rem}.form-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem;width:100%}@media (max-width: 767px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--text-primary);font-size:.9rem;font-weight:500;margin-bottom:.35rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.65rem .75rem;background:var(--background-card);border:1px solid var(--border-color);border-radius:8px;color:var(--text-primary);font-size:.95rem;transition:border-color .2s,box-shadow .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--text-secondary);opacity:.8}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px #00b89433}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:var(--error)}.password-input-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.password-input-field[_ngcontent-%COMP%]{padding-right:3rem;width:100%}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:transparent;border:none;cursor:pointer;padding:.5rem;display:flex;align-items:center;justify-content:center;color:var(--text-secondary);transition:color .2s ease;min-width:32px;min-height:32px;z-index:1}.password-toggle[_ngcontent-%COMP%]:hover{color:var(--text-primary)}.password-toggle[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-color);outline-offset:2px}.password-toggle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.125rem;color:currentColor}.error-msg[_ngcontent-%COMP%]{color:var(--error);font-size:.8rem;margin-top:.25rem;display:block}.auth-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1.25rem}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{flex:1;padding:.6rem 1rem;border-radius:8px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s;text-decoration:none;text-align:center;display:inline-flex;align-items:center;justify-content:center}.btn-cancel[_ngcontent-%COMP%]{background:transparent;color:var(--text-secondary);border:1px solid var(--border-color)}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--background-card);color:var(--text-primary);border-color:var(--border-hover)}.btn-submit[_ngcontent-%COMP%]{background:var(--primary-color);color:var(--background-dark);border:none;box-shadow:var(--shadow-neon)}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){filter:brightness(1.1);box-shadow:var(--shadow-neon)}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}"]})};function U(a,e){if(a&1&&(i(0,"p",4),s(1),r()),a&2){let o=M();n(),F(o.serverError)}}var G=class a{router=f(O);authService=f(E);authStateService=f(I);serverError="";ngOnInit(){if(this.authStateService.value.isAuthenticated){this.router.navigate(["/home"]);return}P(this.authService.refreshToken()).then(e=>{e?.user&&(this.authStateService.setAuthenticated(e.user),this.router.navigate(["/home"]))}).catch(()=>{})}onSubmit(e){this.serverError="",this.authService.register({email:e.email,password:e.password,firstName:e.name,lastName:e.apellido}).subscribe({next:o=>this.router.navigate(["/verify-email-pending"],{queryParams:{email:o.user?.email||e.email}}),error:o=>{this.serverError=o.error?.message||"Error al registrarse. Intenta de nuevo."}})}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=h({type:a,selectors:[["app-register"]],decls:4,vars:1,consts:[[1,"auth-page"],[1,"auth-container"],["class","auth-error",4,"ngIf"],[3,"submitForm"],[1,"auth-error"]],template:function(o,t){o&1&&(i(0,"section",0)(1,"div",1),d(2,U,2,1,"p",2),i(3,"app-register-form",3),u("submitForm",function(j){return t.onSubmit(j)}),r()()()),o&2&&(n(2),m("ngIf",t.serverError))},dependencies:[b,v,w],styles:[".auth-page[_ngcontent-%COMP%]{min-height:80vh;display:flex;align-items:center;justify-content:center;padding:2rem}.auth-error[_ngcontent-%COMP%]{color:var(--error, #e74c3c);font-size:.9rem;margin-bottom:1rem;text-align:center}.auth-container[_ngcontent-%COMP%]{width:100%;max-width:420px;background:var(--background-card);border:1px solid var(--border-color);border-radius:12px;padding:2rem}"]})};export{G as RegisterComponent};
