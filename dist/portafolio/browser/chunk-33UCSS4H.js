import{U as c,_ as h,a as s,b as r,f as n,la as l,m as u,t as o}from"./chunk-VJKI3SXJ.js";var S=class a{injector=h(l);initialized=!1;initialState={isAuthenticated:!1,user:null,isLoading:!0};authStateSubject=new u(this.initialState);authState=this.authStateSubject.asObservable();constructor(){this.initializeAuthState()}initializeAuthState(){return n(this,null,function*(){if(!this.initialized){this.initialized=!0,this.setLoading(!0);try{let{AuthService:t}=yield import("./chunk-WXXCDTTC.js"),e=this.injector.get(t),i=yield o(e.refreshToken());i?.user?this.setAuthenticated(i.user):this.clearState()}catch{this.clearState()}finally{this.setLoading(!1)}}})}setAuthenticated(t){this.authStateSubject.next({isAuthenticated:!0,user:t,isLoading:!1})}setLoggedOut(){this.clearState()}setLoading(t){this.authStateSubject.next(r(s({},this.authStateSubject.value),{isLoading:t}))}clearState(){this.authStateSubject.next(r(s({},this.initialState),{isLoading:!1}))}refreshUserState(){return n(this,null,function*(){if(this.value.isAuthenticated)try{let{AuthService:t}=yield import("./chunk-WXXCDTTC.js"),e=this.injector.get(t),i=yield o(e.refreshToken());i?.user&&this.setAuthenticated(i.user)}catch{this.clearState()}})}get value(){return this.authStateSubject.value}static \u0275fac=function(e){return new(e||a)};static \u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})};export{S as a};
