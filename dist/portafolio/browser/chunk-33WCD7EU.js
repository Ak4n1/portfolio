import{a as ge}from"./chunk-FUWIMROM.js";import{a as ce}from"./chunk-QAUAQUX7.js";import{a as pe}from"./chunk-XY4RB3HP.js";import{a as me}from"./chunk-3736SKJ3.js";import{a as le}from"./chunk-NLD4W7DD.js";import{a as q,b as I}from"./chunk-B7NS5OZX.js";import"./chunk-MQB6D6E4.js";import{e as de,f as T,g as E,h as z,j as R}from"./chunk-IBUNDTLB.js";import"./chunk-46EHWJZL.js";import"./chunk-AB3PYKT6.js";import{o as se,s as _}from"./chunk-L3SKP5V6.js";import{Ab as c,C as G,Eb as h,Ib as l,Jb as b,Kb as ee,Lb as te,Nb as ie,Ob as ne,Pb as oe,Qb as $,Rb as d,Sb as g,Ta as N,U as J,Ua as a,_ as f,_b as P,a as Y,b as W,bc as re,cb as v,dc as ae,fa as p,ga as m,hb as y,ma as K,oa as U,ob as x,oc as S,pb as k,rb as C,sb as Z,ta as X,tb as O,ua as D,v as Q,wb as M,xb as w,yb as i,zb as r}from"./chunk-GWDYAHF2.js";var he=["sidebarContent"],fe=()=>({exact:!1}),ve=(n,e)=>e.title,_e=(n,e)=>e.route;function Ce(n,e){if(n&1){let t=h();i(0,"div",26)(1,"a",27),l("click",function(){p(t);let s=b(2);return m(s.closeSidebar())}),c(2,"i",28),i(3,"span",29),d(4),r()()()}if(n&2){let t=e.$implicit,o=b(2);C("active",o.isActiveRoute(t.route)),a(),k("routerLink",t.route)("routerLinkActiveOptions",P(8,fe)),x("aria-label",t.label),a(),Z(t.icon),a(2),g(t.label)}}function xe(n,e){if(n&1&&(i(0,"div",12)(1,"p",23),d(2),r(),i(3,"div",24),M(4,Ce,5,9,"div",25,_e),r()()),n&2){let t=e.$implicit;a(2),g(t.title),a(2),w(t.items)}}var A=class n{sidebarContentRef;authStateService=f(le);authService=f(ce);router=f(T);isOpen=!1;menuSections=[];userRoles=[];authState=I(this.authStateService.authState,{initialValue:{isAuthenticated:!1,user:null,isLoading:!0}});displayName=S(()=>{let e=this.authState()?.user;if(!e)return"";let t=e.firstName?.trim()||"",o=e.lastName?.trim()||"";return t||o?`${t} ${o}`.trim():e.email||""});initials=S(()=>{let e=this.authState()?.user;if(!e)return"?";let t=(e.firstName||"").trim(),o=(e.lastName||"").trim();return t&&o?(t[0]+o[0]).toUpperCase():t?t.slice(0,2).toUpperCase():e.email?e.email.slice(0,2).toUpperCase():"?"});roleLabel=S(()=>{let e=this.authState()?.user;return e?.roles?.length?e.roles.includes("ROLE_ADMIN")?"Administrador":e.roles.includes("ROLE_USER")?"Usuario":e.roles[0]||"":""});userEmail=S(()=>this.authState()?.user?.email??"");userMenuSections=[{title:"Sistema",items:[{label:"Dashboard",icon:"fas fa-home",route:"/dashboard/user"},{label:"Notificaciones",icon:"fas fa-bell",route:"/dashboard/notificaciones"},{label:"Chat IA",icon:"fas fa-comments",route:"/dashboard/chat"}]},{title:"Sitio",items:[{label:"Proyectos",icon:"fas fa-code",route:"/projects"},{label:"Sobre mi",icon:"fas fa-user",route:"/about"},{label:"Contacto",icon:"fas fa-envelope",route:"/contact"}]}];adminMenuSections=[{title:"Sistema",items:[{label:"Dashboard",icon:"fas fa-home",route:"/dashboard/admin"},{label:"Notificaciones",icon:"fas fa-bell",route:"/dashboard/notificaciones"},{label:"Chat IA",icon:"fas fa-comments",route:"/dashboard/chat"}]},{title:"Gesti\xF3n",items:[{label:"Proyectos",icon:"fas fa-folder-open",route:"/dashboard/projects"},{label:"Noticias",icon:"fas fa-newspaper",route:"/dashboard/noticias"},{label:"Usuarios",icon:"fas fa-users",route:"/dashboard/usuarios"},{label:"Ofertas",icon:"fas fa-briefcase",route:"/dashboard/ofertas"},{label:"Mensajes",icon:"fas fa-address-book",route:"/dashboard/contactos"},{label:"Chatbot IA",icon:"fas fa-robot",route:"/dashboard/chatbot-config"}]}];ngOnInit(){this.authStateService.authState.subscribe(e=>{e.user?(this.userRoles=e.user.roles||[],this.updateMenuItems()):(this.userRoles=[],this.menuSections=[])})}updateMenuItems(){let e=this.userRoles.includes("ROLE_ADMIN");this.menuSections=e?this.adminMenuSections:this.userMenuSections}toggleSidebar(){this.isOpen=!this.isOpen}closeSidebar(){this.isOpen=!1}onDocumentClick(e){if(!this.isOpen)return;let t=e.target;this.sidebarContentRef?.nativeElement?.contains(t)||t.closest?.(".sidebar-toggle-mobile")||this.closeSidebar()}isActiveRoute(e){return this.router.url===e||this.router.url.startsWith(e+"/")}logout(){this.authService.logout().subscribe({next:()=>{this.authStateService.setLoggedOut(),this.closeSidebar(),this.router.navigate(["/login"])},error:()=>{this.authStateService.setLoggedOut(),this.closeSidebar(),this.router.navigate(["/login"])}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["app-sidebar"]],viewQuery:function(t,o){if(t&1&&ie(he,5),t&2){let s;ne(s=oe())&&(o.sidebarContentRef=s.first)}},hostBindings:function(t,o){t&1&&l("click",function(u){return o.onDocumentClick(u)},!1,N)},decls:32,vars:9,consts:[["sidebarContent",""],["role","navigation","aria-label","Men\xFA lateral",1,"sidebar"],[1,"sidebar-overlay",3,"click"],[1,"sidebar-content"],[1,"sidebar-brand"],[1,"sidebar-brand-inner"],["aria-hidden","true",1,"sidebar-brand-icon"],[1,"fas","fa-terminal"],[1,"sidebar-brand-title"],["type","button","aria-label","Cerrar men\xFA",1,"sidebar-close",3,"click"],["aria-hidden","true",1,"fas","fa-times"],[1,"sidebar-nav"],[1,"sidebar-section"],[1,"sidebar-footer"],["routerLink","/dashboard/configuracion","routerLinkActive","sidebar-link-active",1,"sidebar-account-link",3,"click","routerLinkActiveOptions"],["aria-hidden","true",1,"fas","fa-cog"],[1,"sidebar-user-card"],["aria-hidden","true",1,"sidebar-avatar"],[1,"sidebar-user-info"],[1,"sidebar-user-name"],[1,"sidebar-user-role"],["type","button","aria-label","Cerrar sesi\xF3n",1,"sidebar-logout",3,"click"],["aria-hidden","true",1,"fas","fa-sign-out-alt"],[1,"sidebar-section-title"],[1,"sidebar-section-items"],[1,"sidebar-nav-item-wrapper",3,"active"],[1,"sidebar-nav-item-wrapper"],["routerLinkActive","sidebar-link-active",1,"sidebar-link",3,"click","routerLink","routerLinkActiveOptions"],["aria-hidden","true"],[1,"sidebar-link-text"]],template:function(t,o){if(t&1){let s=h();i(0,"aside",1)(1,"div",2),l("click",function(){return p(s),m(o.closeSidebar())}),r(),i(2,"div",3,0)(4,"div",4)(5,"div",5)(6,"div",6),c(7,"i",7),r(),i(8,"span",8),d(9,"Portafolio Ak4n1"),r()(),i(10,"button",9),l("click",function(){return p(s),m(o.closeSidebar())}),c(11,"i",10),r()(),i(12,"nav",11),M(13,xe,6,1,"div",12,ve),r(),i(15,"div",13)(16,"a",14),l("click",function(){return p(s),m(o.closeSidebar())}),c(17,"i",15),i(18,"span"),d(19,"Configuraci\xF3n"),r()(),i(20,"div",16)(21,"div",17),d(22),r(),i(23,"div",18)(24,"p",19),d(25),r(),i(26,"p",20),d(27),r()()(),i(28,"button",21),l("click",function(){return p(s),m(o.logout())}),c(29,"i",22),i(30,"span"),d(31,"Salir"),r()()()()()}t&2&&(C("open",o.isOpen),a(),C("open",o.isOpen),a(12),w(o.menuSections),a(3),k("routerLinkActiveOptions",P(8,fe)),a(6),g(o.initials()),a(3),g(o.displayName()),a(2),g(o.userEmail()))},dependencies:[_,R,E,z],styles:['.sidebar[_ngcontent-%COMP%]{width:var(--sidebar-width);min-height:100vh;background:var(--background-section)!important;border-right:1px solid var(--border-color);color:var(--text-primary);display:flex;flex-direction:column;position:relative;z-index:50}.sidebar-overlay[_ngcontent-%COMP%]{display:none}.sidebar-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:0;position:relative;z-index:1}.sidebar-brand[_ngcontent-%COMP%]{height:var(--header-height);display:flex;align-items:center;justify-content:space-between;padding:0 var(--spacing-lg);margin-bottom:var(--spacing-sm);flex-shrink:0}.sidebar-brand-inner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md)}.sidebar-close[_ngcontent-%COMP%]{display:none;width:44px;height:44px;background:transparent;border:none;color:var(--text-primary);cursor:pointer;align-items:center;justify-content:center;border-radius:var(--border-radius-md);transition:all .2s ease;font-size:var(--font-size-body-large)}.sidebar-close[_ngcontent-%COMP%]:hover{background-color:var(--color-background-hover);color:var(--color-primary)}.sidebar-close[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.sidebar-brand-icon[_ngcontent-%COMP%]{width:var(--spacing-xl);height:var(--spacing-xl);background-color:var(--color-primary);border-radius:var(--border-radius-md);display:flex;align-items:center;justify-content:center;color:#0a0f0e;font-size:var(--font-size-body)}.sidebar-brand-title[_ngcontent-%COMP%]{font-size:20px;font-weight:var(--font-weight-bold);color:var(--text-primary);letter-spacing:var(--letter-spacing-tight)}.sidebar-nav[_ngcontent-%COMP%]{flex:1;padding:0 var(--spacing-md);display:flex;flex-direction:column;gap:var(--spacing-md);overflow-y:auto;padding-bottom:var(--spacing-md);margin-top:20px}.sidebar-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.sidebar-section-title[_ngcontent-%COMP%]{padding:0 var(--spacing-lg);margin-top:var(--spacing-md);margin-bottom:.5rem;font-size:.65rem;font-weight:800;color:color-mix(in srgb,var(--color-primary) 60%,var(--color-text-secondary));text-transform:uppercase;letter-spacing:.15em;opacity:.8}.sidebar-section[_ngcontent-%COMP%]:first-child   .sidebar-section-title[_ngcontent-%COMP%]{margin-top:0}.sidebar-section-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.125rem}.sidebar-nav-item-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.sidebar-nav-item-wrapper[_ngcontent-%COMP%]   .sidebar-link-active[_ngcontent-%COMP%]{background-color:var(--color-primary-light);color:var(--color-primary);font-weight:var(--font-weight-semibold);box-shadow:inset 4px 0 0 var(--color-primary)}.sidebar-nav-item-wrapper[_ngcontent-%COMP%]   .sidebar-link-active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--color-primary)}.sidebar-nav-item-wrapper.active[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:24px;background-color:var(--color-active-indicator);border-radius:0 var(--border-radius-sm) var(--border-radius-sm) 0;z-index:0;pointer-events:none}.sidebar-link[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:var(--spacing-md);padding:.625rem var(--spacing-lg);border-radius:var(--border-radius-md);background-color:transparent;border:none;color:var(--text-secondary);font-size:var(--font-size-body-small);font-weight:var(--font-weight-medium);text-align:left;cursor:pointer;transition:all .2s ease;font-family:var(--font-family);text-decoration:none;position:relative;z-index:1}.sidebar-link[_ngcontent-%COMP%]:hover{background-color:var(--color-background-hover);color:var(--text-primary)}.sidebar-link[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--color-primary)}.sidebar-link[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--color-primary);outline-offset:-2px}.sidebar-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:var(--font-size-body-large);width:1.5rem;text-align:center;color:inherit;transition:color .2s ease}.sidebar-link-text[_ngcontent-%COMP%]{flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sidebar-footer[_ngcontent-%COMP%]{padding:var(--spacing-lg);margin-top:auto;border-top:none;flex-shrink:0;display:flex;flex-direction:column;gap:var(--spacing-md);position:relative}.sidebar-footer[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:50%;transform:translate(-50%);width:calc(100% - (var(--spacing-lg) * 2));max-width:32rem;height:1px;background:linear-gradient(90deg,transparent,var(--text-accent),transparent);pointer-events:none}.sidebar-account-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md);padding:.625rem var(--spacing-lg);border-radius:var(--border-radius-md);background-color:transparent;border:none;color:var(--text-secondary);font-size:var(--font-size-body-small);font-weight:var(--font-weight-medium);text-align:left;cursor:pointer;transition:all .2s ease;font-family:var(--font-family);text-decoration:none;position:relative}.sidebar-account-link[_ngcontent-%COMP%]:hover{background-color:var(--color-background-hover);color:var(--text-primary)}.sidebar-account-link[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--color-primary)}.sidebar-account-link.sidebar-link-active[_ngcontent-%COMP%]{background-color:var(--color-primary-light);color:var(--color-primary);font-weight:var(--font-weight-semibold)}.sidebar-account-link.sidebar-link-active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--color-primary)}.sidebar-account-link.sidebar-link-active[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);width:4px;height:24px;background-color:var(--color-primary);border-radius:0 var(--border-radius-sm) var(--border-radius-sm) 0;pointer-events:none}.sidebar-account-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:var(--font-size-body-large);width:1.5rem;text-align:center;color:inherit;transition:color .2s ease}.sidebar-user-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md);padding:var(--spacing-md);border-radius:var(--border-radius-xl);background-color:var(--color-background-hover)}.sidebar-avatar[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;min-width:2.5rem;min-height:2.5rem;border-radius:var(--border-radius-full);background-color:var(--color-primary-light);color:var(--color-primary);font-weight:var(--font-weight-bold);font-size:var(--font-size-body-small);display:flex;align-items:center;justify-content:center;overflow:hidden;text-transform:uppercase}.sidebar-user-info[_ngcontent-%COMP%]{flex:1;min-width:0}.sidebar-user-name[_ngcontent-%COMP%]{font-size:var(--font-size-body-small);font-weight:var(--font-weight-semibold);color:var(--text-primary);margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sidebar-user-role[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary);margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sidebar-logout[_ngcontent-%COMP%]{margin-top:var(--spacing-md);display:flex;align-items:center;justify-content:center;gap:var(--spacing-sm);width:100%;padding:var(--spacing-sm) var(--spacing-lg);border-radius:var(--border-radius-md);border:none;background:transparent;color:var(--text-secondary);font-size:var(--font-size-body-small);font-weight:var(--font-weight-medium);font-family:var(--font-family);cursor:pointer;transition:all .2s ease}.sidebar-logout[_ngcontent-%COMP%]:hover{background-color:var(--color-logout-hover-bg);color:var(--color-logout-hover-text)}.sidebar-logout[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.sidebar-logout[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:var(--font-size-body)}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100vh;width:280px;max-width:85vw;transform:translate(-100%);transition:transform .3s ease;z-index:1000;box-shadow:0 0 0 1px var(--color-shadow),2px 0 var(--spacing-md) var(--color-shadow);background-color:var(--background-dark)!important;border-right:1px solid var(--border-color);color:var(--text-primary)}.sidebar.open[_ngcontent-%COMP%]{transform:translate(0)}.sidebar-overlay[_ngcontent-%COMP%]{display:block;position:fixed;inset:0;background-color:var(--color-overlay);z-index:999;opacity:0;visibility:hidden;pointer-events:none;transition:opacity .3s ease,visibility .3s ease}.sidebar-overlay.open[_ngcontent-%COMP%]{opacity:1;visibility:visible;pointer-events:auto;cursor:pointer}.sidebar-content[_ngcontent-%COMP%]{z-index:1000;background-color:transparent;min-height:0}.sidebar-brand[_ngcontent-%COMP%]{height:var(--header-height-mobile)}.sidebar-brand-title[_ngcontent-%COMP%]{color:var(--text-primary)}.sidebar-close[_ngcontent-%COMP%]{display:flex;color:var(--text-primary)}.sidebar-link[_ngcontent-%COMP%]{color:var(--text-secondary)}.sidebar-link[_ngcontent-%COMP%]:hover{background-color:var(--color-background-hover);color:var(--text-primary)}.sidebar-link[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--color-primary)}.sidebar-nav-item-wrapper[_ngcontent-%COMP%]   .sidebar-link-active[_ngcontent-%COMP%]{background-color:var(--color-primary-light);color:var(--color-primary)}.sidebar-nav-item-wrapper[_ngcontent-%COMP%]   .sidebar-link-active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--color-primary)}.sidebar-footer[_ngcontent-%COMP%]{border-top-color:var(--border-color)}.sidebar-user-card[_ngcontent-%COMP%]{background-color:var(--color-background-hover)}.sidebar-user-name[_ngcontent-%COMP%]{color:var(--text-primary)}.sidebar-user-role[_ngcontent-%COMP%], .sidebar-logout[_ngcontent-%COMP%]{color:var(--text-secondary)}.sidebar-logout[_ngcontent-%COMP%]:hover{background-color:var(--color-logout-hover-bg);color:var(--color-logout-hover-text)}}@media (max-width: 768px) and (max-height: 560px){.sidebar-content[_ngcontent-%COMP%]{height:100%;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.sidebar-nav[_ngcontent-%COMP%]{flex:0 0 auto;overflow:visible;padding-bottom:0}.sidebar-footer[_ngcontent-%COMP%]{margin-top:0}}@media (min-width: 769px){.sidebar[_ngcontent-%COMP%]{position:fixed;top:0;left:0;height:100vh;overflow-y:auto;overflow-x:hidden}.sidebar-overlay[_ngcontent-%COMP%]{display:none}}']})};var ye="/assets/sounds/notification.mp3",V=class n{play(){try{let e=new Audio(ye);e.volume=.6,e.play().catch(()=>{})}catch{}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})};var ke=()=>({exact:!1}),Oe=(n,e)=>e.id;function Me(n,e){if(n&1&&(i(0,"span",13),d(1),r()),n&2){let t=b();x("aria-label",t.unreadCount()+" sin leer"),a(),g(t.unreadCount())}}function we(n,e){if(n&1){let t=h();i(0,"button",29),l("click",function(){p(t);let s=b(2);return m(s.markAllAsRead())}),d(1,"Leer todas"),r()}}function Pe(n,e){n&1&&(i(0,"div",25),c(1,"i",30),i(2,"p"),d(3,"Cargando\u2026"),r()())}function Se(n,e){n&1&&(i(0,"div",25),c(1,"i",31),i(2,"p"),d(3,"No tienes notificaciones nuevas"),r()())}function De(n,e){if(n&1){let t=h();i(0,"li")(1,"button",32),l("click",function(){let s=p(t).$implicit,u=b(3);return m(u.onNotificationClick(s))}),i(2,"span",33),d(3),r(),i(4,"span",34),d(5),r(),i(6,"span",35),d(7),re(8,"date"),r()()()}if(n&2){let t=e.$implicit;a(),C("unread",!t.read),a(2),g(t.title),a(2),g(t.message),a(2),g(ae(8,5,t.createdAt,"short"))}}function Ne(n,e){if(n&1&&(i(0,"ul",26),M(1,De,9,8,"li",null,Oe),r()),n&2){let t=b(2);a(),w(t.notifications())}}function Te(n,e){if(n&1){let t=h();i(0,"div",14)(1,"div",21)(2,"h2",22),d(3,"Notificaciones"),r(),y(4,we,2,0,"button",23),r(),i(5,"div",24),y(6,Pe,4,0,"div",25)(7,Se,4,0,"div",25)(8,Ne,3,0,"ul",26),r(),i(9,"div",27)(10,"button",28),l("click",function(){p(t);let s=b();return m(s.goToAllNotifications())}),d(11,"Ver todas"),r()()()}if(n&2){let t=b();a(4),O(t.unreadCount()>0?4:-1),a(2),O(t.loadingNotifications()?6:t.notifications().length===0?7:8)}}var Ee=new Set(["CONTACT_SUBMITTED","USER_REGISTERED","EMAIL_VERIFIED","NOTIFICATION_COUNT_UPDATED"]),F=class n{sidebarToggle=new U;closeSidebarRequest=new U;elementRef=f(X);destroyRef=f(K);notificationService=f(ge);notificationSound=f(V);router=f(T);themeService=f(pe);ws=f(me);isNotificationsOpen=!1;unreadCount=D(0);notifications=D([]);loadingNotifications=D(!1);isDarkMode=I(this.themeService.currentTheme$.pipe(Q(e=>e==="dark")),{initialValue:this.themeService.getCurrentTheme()==="dark"});get todayFormatted(){return new Date().toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}ngOnInit(){this.refreshUnreadCount(),this.notificationService.getUnreadCountChanged().pipe(q(this.destroyRef)).subscribe(()=>this.refreshUnreadCount()),this.ws.messages.pipe(G(e=>Ee.has(e.type)),q(this.destroyRef)).subscribe(()=>{setTimeout(()=>{this.notificationSound.play(),this.refreshUnreadCount(),this.isNotificationsOpen&&this.loadNotifications()},0)})}toggleSidebar(){this.sidebarToggle.emit()}toggleTheme(){this.themeService.toggleTheme()}toggleNotifications(){this.isNotificationsOpen=!this.isNotificationsOpen,this.isNotificationsOpen&&(this.closeSidebarRequest.emit(),this.loadNotifications())}closeNotifications(){this.isNotificationsOpen=!1}loadNotifications(){this.loadingNotifications.set(!0),this.notificationService.getNotifications({page:0,size:10}).subscribe({next:e=>{this.notifications.set(e.notifications??[]),this.loadingNotifications.set(!1)},error:()=>{this.notifications.set([]),this.loadingNotifications.set(!1)}})}refreshUnreadCount(){this.notificationService.getUnreadCount().subscribe({next:e=>{this.unreadCount.set(e)},error:()=>{}})}onNotificationClick(e){if(e.read){this.goToRelated(e);return}this.notificationService.markAsRead(e.id).subscribe({next:()=>{e.read=!0,this.unreadCount.update(t=>Math.max(0,t-1)),this.goToRelated(e)},error:()=>this.goToRelated(e)})}goToRelated(e){this.closeNotifications(),e.relatedEntityType&&e.relatedEntityId&&e.relatedEntityType==="PROJECT"&&this.router.navigate(["/dashboard/projects",e.relatedEntityId])}goToAllNotifications(){this.closeNotifications(),this.router.navigate(["/dashboard/notificaciones"])}markAllAsRead(){this.unreadCount()!==0&&this.notificationService.markAllAsRead().subscribe({next:()=>{this.unreadCount.set(0),this.notifications.update(e=>e.map(t=>W(Y({},t),{read:!0}))),this.isNotificationsOpen&&this.loadNotifications()},error:()=>{}})}onDocumentClick(e){!this.isNotificationsOpen||this.elementRef.nativeElement.contains(e.target)||this.closeNotifications()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["app-dashboard-header"]],hostBindings:function(t,o){t&1&&l("click",function(u){return o.onDocumentClick(u)},!1,N)},outputs:{sidebarToggle:"sidebarToggle",closeSidebarRequest:"closeSidebarRequest"},decls:24,vars:10,consts:[["role","banner",1,"dashboard-header"],[1,"dashboard-header-content"],[1,"dashboard-header-left"],["type","button","aria-label","Abrir men\xFA",1,"sidebar-toggle-mobile",3,"click"],["aria-hidden","true",1,"fas","fa-bars"],["aria-label","Navegaci\xF3n principal",1,"dashboard-header-nav"],["routerLink","/home","routerLinkActive","nav-link-active","aria-label","Ir al portafolio",1,"nav-link",3,"routerLinkActiveOptions"],["aria-hidden","true",1,"fas","fa-globe"],[1,"nav-link-text"],[1,"dashboard-header-right"],[1,"notifications-wrapper"],["type","button","aria-label","Notificaciones","aria-haspopup","true",1,"notifications-trigger",3,"click"],["aria-hidden","true",1,"fas","fa-bell"],[1,"notifications-badge"],["role","dialog","aria-label","Panel de notificaciones",1,"notifications-dropdown"],[1,"dashboard-header-theme",3,"click"],[1,"theme-track"],[1,"theme-thumb"],[1,"theme-icon"],["aria-hidden","true",1,"dashboard-header-separator"],[1,"dashboard-header-date"],[1,"notifications-dropdown-header"],[1,"notifications-dropdown-title"],["type","button",1,"notifications-header-link"],[1,"notifications-dropdown-body"],[1,"notifications-empty"],["role","list",1,"notifications-list"],[1,"notifications-dropdown-footer"],["type","button",1,"notifications-footer-link",3,"click"],["type","button",1,"notifications-header-link",3,"click"],["aria-hidden","true",1,"fas","fa-spinner","fa-spin"],["aria-hidden","true",1,"fas","fa-bell-slash"],["type","button",1,"notifications-list-item",3,"click"],[1,"notifications-item-title"],[1,"notifications-item-message"],[1,"notifications-item-time"]],template:function(t,o){t&1&&(i(0,"header",0)(1,"div",1)(2,"div",2)(3,"button",3),l("click",function(){return o.toggleSidebar()}),c(4,"i",4),r(),i(5,"nav",5)(6,"a",6),c(7,"i",7),i(8,"span",8),d(9,"Ir al portafolio"),r()()()(),i(10,"div",9)(11,"div",10)(12,"button",11),l("click",function(){return o.toggleNotifications()}),c(13,"i",12),y(14,Me,2,2,"span",13),r(),y(15,Te,12,2,"div",14),r(),i(16,"div",15),l("click",function(){return o.toggleTheme()}),i(17,"div",16)(18,"div",17)(19,"span",18),d(20),r()()()(),c(21,"span",19),i(22,"span",20),d(23),r()()()()),t&2&&(a(6),k("routerLinkActiveOptions",P(9,ke)),a(6),x("aria-expanded",o.isNotificationsOpen),a(2),O(o.unreadCount()>0?14:-1),a(),O(o.isNotificationsOpen?15:-1),a(),x("aria-label",o.isDarkMode()?"Cambiar a modo claro":"Cambiar a modo oscuro"),a(),C("active",o.isDarkMode()),a(3),g(o.isDarkMode()?"\u{1F319}":"\u2600\uFE0F"),a(3),g(o.todayFormatted))},dependencies:[_,se,R,E,z],styles:[".dashboard-header[_ngcontent-%COMP%]{width:100%;height:var(--header-height);min-height:var(--header-height);background:var(--background-hero)!important;border-bottom:1px solid var(--border-color);padding:0 var(--spacing-xl);position:sticky;top:0;z-index:40;box-shadow:var(--shadow-card);display:flex;align-items:center;flex-shrink:0}.dashboard-header-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;gap:var(--spacing-lg);width:100%}.dashboard-header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md);flex:1}.dashboard-header-nav[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;padding:0 var(--spacing-md)}.nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm);padding:.625rem var(--spacing-lg);border-radius:var(--border-radius-md);background-color:transparent;color:var(--text-secondary);font-size:var(--font-size-body-small);font-weight:var(--font-weight-medium);text-decoration:none;cursor:pointer;transition:all .2s ease;font-family:var(--font-family);white-space:nowrap;position:relative}.nav-link[_ngcontent-%COMP%]:hover{background-color:var(--color-background-hover);color:var(--text-primary)}.nav-link[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--color-primary)}.nav-link[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--color-primary);outline-offset:-2px}.nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:var(--font-size-body-large);width:1.5rem;text-align:center;color:inherit;transition:color .2s ease}.nav-link-text[_ngcontent-%COMP%]{flex:1}.nav-link-active[_ngcontent-%COMP%]{background-color:var(--color-primary-light);color:var(--color-primary);font-weight:var(--font-weight-semibold);box-shadow:inset 0 -3px 0 var(--color-primary)}.nav-link-active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--color-primary)}.sidebar-toggle-mobile[_ngcontent-%COMP%]{display:none;width:44px;height:44px;background-color:transparent;border:none;color:var(--text-primary);cursor:pointer;align-items:center;justify-content:center;border-radius:var(--border-radius-md);transition:all .2s ease;font-size:var(--font-size-body-large)}.sidebar-toggle-mobile[_ngcontent-%COMP%]:hover{background-color:var(--color-background-hover);color:var(--color-primary)}.sidebar-toggle-mobile[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.dashboard-header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md);flex-shrink:0}.notifications-wrapper[_ngcontent-%COMP%]{position:relative}.notifications-trigger[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;padding:0;background:none;border:none;border-radius:var(--border-radius-md);color:var(--color-primary);font-size:1.25rem;cursor:pointer;transition:box-shadow .2s ease;position:relative;box-shadow:none}.notifications-trigger[_ngcontent-%COMP%]:hover{box-shadow:0 0 12px color-mix(in srgb,var(--color-primary) 60%,transparent),0 0 24px color-mix(in srgb,var(--color-primary) 30%,transparent)}.notifications-trigger[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.notifications-trigger[aria-expanded=true][_ngcontent-%COMP%]{color:var(--color-primary);box-shadow:0 0 12px color-mix(in srgb,var(--color-primary) 60%,transparent),0 0 24px color-mix(in srgb,var(--color-primary) 30%,transparent)}.notifications-badge[_ngcontent-%COMP%]{position:absolute;top:4px;right:4px;min-width:18px;height:18px;padding:0 5px;display:flex;align-items:center;justify-content:center;font-size:.7rem;font-weight:700;color:#fff;background-color:#dc2626;border-radius:9999px;line-height:1}.notifications-dropdown[_ngcontent-%COMP%]{position:absolute;right:0;top:calc(100% + 8px);left:auto;width:min(360px,calc(100vw - 2rem));max-height:min(420px,70vh);background:var(--background-hero);border:1px solid var(--border-color);border-radius:var(--border-radius-lg);box-shadow:var(--shadow-card);display:flex;flex-direction:column;z-index:100;overflow:hidden;animation:_ngcontent-%COMP%_notificationsDropdownIn .2s ease}@keyframes _ngcontent-%COMP%_notificationsDropdownIn{0%{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_notificationsDropdownInMobile{0%{opacity:0;transform:translate(-50%) translateY(-6px)}to{opacity:1;transform:translate(-50%) translateY(0)}}.notifications-dropdown-header[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;justify-content:space-between;gap:1rem;padding:1rem 1.25rem;border-bottom:1px solid var(--border-color);background:var(--color-surface)}.notifications-dropdown-title[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:700;color:var(--text-primary)}.notifications-header-link[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:var(--color-primary);background:none;border:none;cursor:pointer;padding:0;font-family:inherit;flex-shrink:0}.notifications-header-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.notifications-dropdown-body[_ngcontent-%COMP%]{flex:1;min-height:120px;max-height:320px;overflow-y:auto;padding:.5rem 0}.notifications-empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.75rem;padding:2rem 1.5rem;color:var(--text-secondary);text-align:center}.notifications-empty[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;opacity:.6}.notifications-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9375rem}.notifications-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.notifications-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:0;padding:0}.notifications-list-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:.25rem;width:100%;padding:.75rem 1.25rem;text-align:left;font-family:inherit;font-size:.875rem;color:var(--text-primary);background:none;border:none;border-bottom:1px solid var(--border-color);cursor:pointer;transition:background .15s ease}.notifications-list-item[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.notifications-list-item[_ngcontent-%COMP%]:hover{background:var(--color-background-hover)}.notifications-list-item.unread[_ngcontent-%COMP%]{background:var(--color-primary-light)}.notifications-list-item.unread[_ngcontent-%COMP%]:hover{background:var(--color-primary-light);filter:brightness(.97)}.notifications-item-title[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary)}.notifications-item-message[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.8125rem;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.notifications-item-time[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary);margin-top:.125rem}.notifications-dropdown-footer[_ngcontent-%COMP%]{flex-shrink:0;padding:.75rem 1.25rem;border-top:1px solid var(--border-color);background:var(--color-surface);text-align:center}.notifications-footer-link[_ngcontent-%COMP%]{display:inline-block;font-size:.875rem;font-weight:600;color:var(--color-primary);text-decoration:none;transition:color .2s ease;background:none;border:none;cursor:pointer;padding:0;font-family:inherit}.notifications-footer-link[_ngcontent-%COMP%]:hover{text-decoration:underline}@media (max-width: 769px){.notifications-dropdown[_ngcontent-%COMP%]{position:fixed;left:50%;right:auto;transform:translate(-50%);top:calc(var(--header-height-mobile, 56px) + 8px);max-height:65vh;animation:_ngcontent-%COMP%_notificationsDropdownInMobile .2s ease}.notifications-trigger[_ngcontent-%COMP%]{width:44px;height:44px}}.dashboard-header-separator[_ngcontent-%COMP%]{width:1px;height:var(--spacing-xl);background-color:var(--border-color);margin:0 var(--spacing-sm)}.dashboard-header-date[_ngcontent-%COMP%]{font-size:var(--font-size-body-small);font-weight:var(--font-weight-medium);color:var(--text-secondary)}.dashboard-header-theme[_ngcontent-%COMP%]{cursor:pointer;padding:.25rem;display:flex;align-items:center;justify-content:center;margin-right:var(--spacing-sm)}.theme-track[_ngcontent-%COMP%]{width:2.5rem;height:1.375rem;background:var(--background-light);border:2px solid var(--border-color);border-radius:9999px;position:relative;transition:background .2s ease,border-color .2s ease}.theme-track.active[_ngcontent-%COMP%]{background:var(--color-primary);border-color:var(--color-primary)}.theme-thumb[_ngcontent-%COMP%]{position:absolute;top:50%;left:2px;transform:translateY(-50%);width:1.25rem;height:1.25rem;border-radius:50%;background:var(--text-primary);display:flex;align-items:center;justify-content:center;transition:left .2s ease;box-shadow:0 1px 3px #0003}.theme-track.active[_ngcontent-%COMP%]   .theme-thumb[_ngcontent-%COMP%]{left:1.125rem;background:var(--background-dark)}.theme-icon[_ngcontent-%COMP%]{font-size:.625rem;line-height:1}@media (max-width: 769px){.dashboard-header[_ngcontent-%COMP%]{height:var(--header-height-mobile);min-height:var(--header-height-mobile);padding:0 var(--spacing-md);z-index:1001}.dashboard-header-content[_ngcontent-%COMP%]{width:100%;min-height:44px}.dashboard-header-left[_ngcontent-%COMP%]{gap:var(--spacing-sm)}.sidebar-toggle-mobile[_ngcontent-%COMP%]{display:flex}.dashboard-header-nav[_ngcontent-%COMP%]{padding:0}.nav-link[_ngcontent-%COMP%]{padding:.5rem;min-width:2.5rem;justify-content:center;font-size:var(--font-size-body-small)}.nav-link-text[_ngcontent-%COMP%]{display:none}.dashboard-header-right[_ngcontent-%COMP%]{gap:.375rem}.dashboard-header-separator[_ngcontent-%COMP%]{margin:0 .25rem}.dashboard-header-date[_ngcontent-%COMP%]{font-size:.75rem;white-space:nowrap}}"],changeDetection:0})};var ze=["*"],H=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["app-dashboard-layout"]],ngContentSelectors:ze,decls:7,vars:0,consts:[["sidebar",""],[1,"dashboard-layout"],["role","main",1,"dashboard-layout-main"],[3,"sidebarToggle","closeSidebarRequest"],[1,"dashboard-layout-content"]],template:function(t,o){if(t&1){let s=h();ee(),i(0,"div",1),c(1,"app-sidebar",null,0),i(3,"main",2)(4,"app-dashboard-header",3),l("sidebarToggle",function(){p(s);let j=$(2);return m(j.toggleSidebar())})("closeSidebarRequest",function(){p(s);let j=$(2);return m(j.closeSidebar())}),r(),i(5,"div",4),te(6),r()()()}},dependencies:[_,A,F],styles:["[_nghost-%COMP%]{display:block;height:100%;min-height:100%}.dashboard-layout[_ngcontent-%COMP%]{min-height:100dvh;height:100dvh;display:flex;flex-direction:row;background:var(--background-hero)!important;overflow:hidden}.dashboard-layout-main[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;min-width:0;overflow:hidden;margin-left:0;padding-top:0!important}@media (min-width: 769px){.dashboard-layout-main[_ngcontent-%COMP%]{margin-left:var(--sidebar-width)}}.dashboard-layout-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch;touch-action:pan-y;background:var(--background-hero)!important;min-height:0}.dashboard-layout-content[_ngcontent-%COMP%]   router-outlet[_ngcontent-%COMP%]{display:contents}@media (max-width: 768px){.dashboard-layout-main[_ngcontent-%COMP%]{margin-left:0}.dashboard-layout-content[_ngcontent-%COMP%]{padding:.4rem}}"],changeDetection:0})};var ue=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=v({type:n,selectors:[["app-dashboard-layout-wrapper"]],decls:2,vars:0,template:function(t,o){t&1&&(i(0,"app-dashboard-layout"),c(1,"router-outlet"),r())},dependencies:[_,H,de],styles:["[_nghost-%COMP%]{display:block;position:relative;min-height:100dvh;z-index:1}"]})};export{ue as DashboardLayoutWrapperComponent};
