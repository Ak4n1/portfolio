import{a as E}from"./chunk-QAUAQUX7.js";import{c as I,d,e as L,f as N,k as z,m as T,n as D,v as A,x as G}from"./chunk-IGSUT72Y.js";import{c as k}from"./chunk-4ZIDF6L4.js";import"./chunk-MQB6D6E4.js";import{f as S,g as F}from"./chunk-IBUNDTLB.js";import"./chunk-46EHWJZL.js";import"./chunk-AB3PYKT6.js";import{k as f,s as h}from"./chunk-L3SKP5V6.js";import{Ab as l,Ib as p,Jb as M,Rb as i,Sb as O,Ua as s,Za as x,_ as u,cb as g,hb as c,ob as y,pb as m,ra as _,rb as C,sb as P,t as w,yb as t,zb as o}from"./chunk-GWDYAHF2.js";function Y(a,r){a&1&&(t(0,"span",18),i(1,"Email v\xE1lido requerido"),o())}function H(a,r){a&1&&(t(0,"span",18),i(1,"M\xEDnimo 6 caracteres"),o())}var v=class a{constructor(r){this.fb=r;this.form=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]]})}submitForm=_();close=_();form;isFieldInvalid(r){let e=this.form.get(r);return!!e&&e.invalid&&(e.dirty||e.touched)}showPassword=!1;togglePassword(){this.showPassword=!this.showPassword}onSubmit(){this.form.valid?this.submitForm.emit(this.form.value):Object.keys(this.form.controls).forEach(r=>this.form.get(r)?.markAsTouched())}onClose(){this.close.emit()}static \u0275fac=function(e){return new(e||a)(x(A))};static \u0275cmp=g({type:a,selectors:[["app-login-form"]],outputs:{submitForm:"submitForm",close:"close"},decls:25,vars:12,consts:[[1,"auth-form"],[1,"auth-title"],[1,"auth-subtitle"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","login-email"],[1,"input-with-icon"],[1,"fas","fa-envelope","input-icon"],["id","login-email","type","email","formControlName","email","placeholder","tu@email.com"],["class","error-msg",4,"ngIf"],["for","login-password"],[1,"password-input-wrapper","input-with-icon"],[1,"fas","fa-lock","input-icon"],["id","login-password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"password-input-field",3,"type"],["type","button",1,"password-toggle",3,"click"],["aria-hidden","true"],[1,"auth-actions"],["type","submit",1,"btn-submit",3,"disabled"],[1,"error-msg"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"h2",1),i(2,"Ingresar"),o(),t(3,"p",2),i(4,"Ingresa tus credenciales para acceder"),o(),t(5,"form",3),p("ngSubmit",function(){return n.onSubmit()}),t(6,"div",4)(7,"label",5),i(8,"Email"),o(),t(9,"div",6),l(10,"i",7)(11,"input",8),o(),c(12,Y,2,0,"span",9),o(),t(13,"div",4)(14,"label",10),i(15,"Contrase\xF1a"),o(),t(16,"div",11),l(17,"i",12)(18,"input",13),t(19,"button",14),p("click",function(){return n.togglePassword()}),l(20,"i",15),o()(),c(21,H,2,0,"span",9),o(),t(22,"div",16)(23,"button",17),i(24,"Entrar"),o()()()()),e&2&&(s(5),m("formGroup",n.form),s(6),C("error",n.isFieldInvalid("email")),s(),m("ngIf",n.isFieldInvalid("email")),s(6),C("error",n.isFieldInvalid("password")),m("type",n.showPassword?"text":"password"),s(),y("aria-label",n.showPassword?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),s(),P(n.showPassword?"fas fa-eye":"fas fa-eye-slash"),s(),m("ngIf",n.isFieldInvalid("password")),s(2),m("disabled",n.form.invalid))},dependencies:[G,z,I,L,N,T,D,h,f],styles:[".auth-form[_ngcontent-%COMP%]{padding:.5rem}.auth-title[_ngcontent-%COMP%]{color:var(--color-primary);font-size:1.75rem;font-weight:700;margin-bottom:.5rem;text-align:center}.auth-subtitle[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:.8125rem;text-transform:uppercase;letter-spacing:.05em;text-align:center;margin-bottom:2rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--color-text-secondary);font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.5rem;margin-left:.25rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem .875rem 2.75rem;background:color-mix(in srgb,var(--color-text-primary) 8%,transparent);border:1px solid color-mix(in srgb,var(--color-text-primary) 25%,transparent);border-radius:var(--border-radius-md);color:var(--color-text-primary);font-size:1rem;transition:border-color .2s,box-shadow .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--color-text-secondary);opacity:.5}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 2px color-mix(in srgb,var(--color-primary) 25%,transparent)}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:var(--error)}.input-with-icon[_ngcontent-%COMP%]{position:relative;width:100%}.input-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--color-text-secondary);font-size:1rem;pointer-events:none;z-index:2;transition:color .2s ease}.password-input-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.password-input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{left:1rem}.password-input-field[_ngcontent-%COMP%]{padding-right:3rem;width:100%}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:transparent;border:none;cursor:pointer;padding:.5rem;display:flex;align-items:center;justify-content:center;color:var(--text-secondary);transition:color .2s ease;min-width:32px;min-height:32px;z-index:1}.password-toggle[_ngcontent-%COMP%]:hover{color:var(--color-primary)}.password-toggle[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-color);outline-offset:2px}.password-toggle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.125rem;color:currentColor}.error-msg[_ngcontent-%COMP%]{color:var(--error);font-size:.8rem;margin-top:.25rem;display:block}.auth-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1.25rem}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{flex:1;padding:.6rem 1rem;border-radius:8px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s}.btn-cancel[_ngcontent-%COMP%]{background:transparent;color:var(--text-secondary);border:1px solid var(--border-color)}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--background-card);color:var(--text-primary);border-color:var(--border-hover)}.btn-submit[_ngcontent-%COMP%]{background:var(--color-primary);color:var(--background-dark);border:none;font-weight:800;text-transform:uppercase;letter-spacing:.05em;box-shadow:var(--shadow-neon)}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){filter:brightness(1.1);box-shadow:0 0 20px color-mix(in srgb,var(--color-primary) 40%,transparent);transform:translateY(-2px)}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed;box-shadow:none}"]})};function J(a,r){if(a&1&&(t(0,"p",7),i(1),o()),a&2){let e=M();s(),O(e.serverError)}}var j=class a{router=u(S);authService=u(E);authStateService=u(k);serverError="";ngOnInit(){if(this.authStateService.value.isAuthenticated){this.router.navigate(["/dashboard"]);return}w(this.authService.refreshToken()).then(r=>{r?.user&&(this.authStateService.setAuthenticated(r.user),this.router.navigate(["/dashboard"]))}).catch(()=>{})}onClose(){this.router.navigate(["/home"])}onSubmit(r){this.serverError="",this.authService.login(r.email,r.password).subscribe({next:e=>{this.authStateService.setAuthenticated(e.user),this.router.navigate(["/dashboard"])},error:e=>{if(e.status===403&&e.error?.message?.includes("verificado")){this.router.navigate(["/verify-email-pending"],{queryParams:{email:r.email,fromLogin:"true"}});return}this.serverError=e.error?.message||"Email o contrase\xF1a inv\xE1lidos"}})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["app-login"]],decls:11,vars:1,consts:[[1,"auth-page"],[1,"auth-container"],["class","auth-error",4,"ngIf"],[3,"submitForm","close"],[1,"auth-footer"],["routerLink","/register"],["routerLink","/forgot-password"],[1,"auth-error"]],template:function(e,n){e&1&&(t(0,"section",0)(1,"div",1),c(2,J,2,1,"p",2),t(3,"app-login-form",3),p("submitForm",function(B){return n.onSubmit(B)})("close",function(){return n.onClose()}),o(),t(4,"p",4),i(5," \xBFNo tienes cuenta? "),t(6,"a",5),i(7,"Registrarse"),o(),l(8,"br"),t(9,"a",6),i(10,"\xBFOlvidaste tu contrase\xF1a?"),o()()()()),e&2&&(s(2),m("ngIf",n.serverError))},dependencies:[h,f,v,F],styles:[".auth-page[_ngcontent-%COMP%]{min-height:80vh;display:flex;align-items:center;justify-content:center;padding:2rem}.auth-container[_ngcontent-%COMP%]{width:100%;max-width:420px;background:color-mix(in srgb,var(--color-primary) 6%,var(--background-dark));-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid color-mix(in srgb,var(--color-primary) 12%,transparent);border-radius:.75rem;padding:2.5rem;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:var(--shadow-card)}.auth-container[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:var(--color-primary);box-shadow:var(--shadow-neon)}.auth-error[_ngcontent-%COMP%]{color:var(--error, #e74c3c);font-size:.9rem;margin-bottom:1rem;text-align:center}.auth-footer[_ngcontent-%COMP%]{text-align:center;margin-top:1.25rem;font-size:.95rem;color:var(--text-secondary)}.auth-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-color);text-decoration:none;font-weight:600}.auth-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};export{j as LoginComponent};
