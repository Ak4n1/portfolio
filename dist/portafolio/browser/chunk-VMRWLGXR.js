import{a as I}from"./chunk-RN22FLO7.js";import{c as R,d as b,e as z,f as N,k as T,m as V,n as G,u as L,w as D}from"./chunk-SBYHMJI5.js";import{d as k,f as F,g as E}from"./chunk-3STYZOIF.js";import"./chunk-DW4U6NCB.js";import"./chunk-WY3MPDUA.js";import{k as O,s as S}from"./chunk-RKUWSNO2.js";import{Ab as p,Eb as _,Ib as w,Jb as l,Rb as i,Sb as y,Tb as M,Ua as n,_ as m,cb as x,fa as u,ga as g,hb as f,ob as v,pb as c,rb as C,sb as P,tb as h,yb as t,zb as r}from"./chunk-VJKI3SXJ.js";function Y(a,o){a&1&&(t(0,"span",18),i(1,"M\xEDnimo 6 caracteres"),r())}function A(a,o){a&1&&(t(0,"span",18),i(1,"Las contrase\xF1as no coinciden"),r())}function q(a,o){if(a&1){let e=_();t(0,"h2",2),i(1,"Nueva Contrase\xF1a"),r(),t(2,"p",3),i(3,"Ingresa tu nueva contrase\xF1a."),r(),t(4,"form",4),w("ngSubmit",function(){u(e);let d=l();return g(d.onSubmit())}),t(5,"div",5)(6,"label",6),i(7,"Nueva contrase\xF1a"),r(),t(8,"div",7),p(9,"i",8)(10,"input",9),t(11,"button",10),w("click",function(){u(e);let d=l();return g(d.togglePassword())}),p(12,"i",11),r()(),f(13,Y,2,0,"span",12),r(),t(14,"div",5)(15,"label",13),i(16,"Confirmar contrase\xF1a"),r(),t(17,"div",7),p(18,"i",14)(19,"input",15),t(20,"button",10),w("click",function(){u(e);let d=l();return g(d.toggleConfirmPassword())}),p(21,"i",11),r()(),f(22,A,2,0,"span",12),r(),t(23,"div",16)(24,"button",17),i(25),r()()()}if(a&2){let e=l();n(4),c("formGroup",e.form),n(6),C("error",e.isFieldInvalid("newPassword")),c("type",e.showPassword?"text":"password"),n(),v("aria-label",e.showPassword?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),n(),P(e.showPassword?"fas fa-eye":"fas fa-eye-slash"),n(),c("ngIf",e.isFieldInvalid("newPassword")),n(6),C("error",e.isConfirmInvalid()),c("type",e.showConfirmPassword?"text":"password"),n(),v("aria-label",e.showConfirmPassword?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),n(),P(e.showConfirmPassword?"fas fa-eye":"fas fa-eye-slash"),n(),c("ngIf",e.isConfirmInvalid()),n(2),c("disabled",e.form.invalid||e.isSubmitting),n(),M(" ",e.isSubmitting?"Guardando...":"Restablecer"," ")}}function B(a,o){a&1&&(t(0,"h2",2),i(1,"\xA1Contrase\xF1a actualizada!"),r(),t(2,"div",19)(3,"p",20),i(4,"Ya puedes iniciar sesi\xF3n con tu nueva contrase\xF1a."),r(),t(5,"div",21)(6,"a",22),i(7,"Iniciar Sesi\xF3n"),r()()())}function U(a,o){if(a&1&&(t(0,"h2",2),i(1,"Error"),r(),t(2,"p",23),i(3),r(),t(4,"div",16)(5,"a",24),i(6,"Solicitar nuevo enlace"),r(),t(7,"a",22),i(8,"Ir a Login"),r()()),a&2){let e=l();n(3),y(e.errorMessage)}}var j=class a{fb=m(L);route=m(k);router=m(F);authService=m(I);form;isSubmitting=!1;state="form";errorMessage="";token="";showPassword=!1;showConfirmPassword=!1;constructor(){this.form=this.fb.group({newPassword:["",[b.required,b.minLength(6)]],confirmPassword:["",[b.required]]},{validators:this.passwordMatchValidator})}passwordMatchValidator(o){let e=o.get("newPassword")?.value,s=o.get("confirmPassword")?.value;return e===s?null:{mismatch:!0}}ngOnInit(){this.route.params.subscribe(o=>{this.token=o.token||"",this.token||(this.state="error",this.errorMessage="Token no encontrado. Usa el enlace del email.")})}isFieldInvalid(o){let e=this.form.get(o);return!!e&&e.invalid&&(e.dirty||e.touched)}isConfirmInvalid(){let o=this.form.get("confirmPassword");return!!o&&this.form.hasError("mismatch")&&(o.dirty||o.touched)}onSubmit(){if(this.form.invalid||this.isSubmitting||!this.token)return;this.isSubmitting=!0,this.errorMessage="";let o=this.form.get("newPassword")?.value;this.authService.resetPassword(this.token,o).subscribe({next:()=>{this.isSubmitting=!1,this.state="success"},error:e=>{this.isSubmitting=!1,this.state="error",this.errorMessage=e.error?.message||"El enlace ha expirado o ya fue utilizado."}})}goToLogin(){this.router.navigate(["/login"])}goToForgotPassword(){this.router.navigate(["/forgot-password"])}togglePassword(){this.showPassword=!this.showPassword}toggleConfirmPassword(){this.showConfirmPassword=!this.showConfirmPassword}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=x({type:a,selectors:[["app-reset-password"]],decls:5,vars:3,consts:[[1,"auth-page"],[1,"auth-container"],[1,"auth-title"],[1,"auth-message"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","newPassword"],[1,"password-input-wrapper","input-with-icon"],[1,"fas","fa-lock","input-icon"],["id","newPassword","formControlName","newPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"password-input-field",3,"type"],["type","button",1,"password-toggle",3,"click"],["aria-hidden","true"],["class","error-msg",4,"ngIf"],["for","confirmPassword"],[1,"fas","fa-shield-halved","input-icon"],["id","confirmPassword","formControlName","confirmPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"password-input-field",3,"type"],[1,"auth-actions"],["type","submit",1,"btn-submit",3,"disabled"],[1,"error-msg"],[1,"auth-message-container"],[1,"auth-success"],[1,"auth-actions","centered"],["routerLink","/login",1,"btn-submit"],[1,"auth-error"],["routerLink","/forgot-password",1,"btn-secondary"]],template:function(e,s){e&1&&(t(0,"section",0)(1,"div",1),f(2,q,26,17)(3,B,8,0)(4,U,9,1),r()()),e&2&&(n(2),h(s.state==="form"?2:-1),n(),h(s.state==="success"?3:-1),n(),h(s.state==="error"?4:-1))},dependencies:[S,O,D,T,R,z,N,V,G,E],styles:[".auth-page[_ngcontent-%COMP%]{min-height:80vh;display:flex;align-items:center;justify-content:center;padding:2rem}.auth-container[_ngcontent-%COMP%]{width:100%;max-width:420px;background:color-mix(in srgb,var(--color-primary) 6%,var(--background-dark));-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid color-mix(in srgb,var(--color-primary) 12%,transparent);border-radius:.75rem;padding:2.5rem;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:var(--shadow-card)}.auth-container[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:var(--color-primary);box-shadow:var(--shadow-neon)}.auth-title[_ngcontent-%COMP%]{color:var(--color-primary);font-size:1.75rem;font-weight:700;margin-bottom:1.5rem;text-align:center}.auth-message[_ngcontent-%COMP%], .auth-success[_ngcontent-%COMP%], .auth-error[_ngcontent-%COMP%]{margin-bottom:1.25rem;color:var(--color-text-primary);line-height:1.6;text-align:center}.auth-message-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.auth-success[_ngcontent-%COMP%]{color:var(--primary-color)}.auth-error[_ngcontent-%COMP%]{color:var(--error, #e74c3c)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--color-text-secondary);font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.5rem;margin-left:.25rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem .875rem 2.75rem;background:color-mix(in srgb,var(--color-text-primary) 8%,transparent);border:1px solid color-mix(in srgb,var(--color-text-primary) 25%,transparent);border-radius:var(--border-radius-md);color:var(--color-text-primary);font-size:1rem;transition:all .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 2px color-mix(in srgb,var(--color-primary) 25%,transparent)}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:var(--error, #e74c3c)}.input-with-icon[_ngcontent-%COMP%]{position:relative;width:100%}.input-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--color-text-secondary);font-size:1rem;pointer-events:none;z-index:2;transition:color .2s ease}.password-input-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.password-input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{left:1rem}.password-input-field[_ngcontent-%COMP%]{padding-right:3rem!important}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:transparent;border:none;cursor:pointer;padding:.5rem;display:flex;align-items:center;justify-content:center;color:var(--color-text-secondary);transition:color .2s ease;min-width:32px;z-index:3}.password-toggle[_ngcontent-%COMP%]:hover{color:var(--color-primary)}.password-toggle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.error-msg[_ngcontent-%COMP%]{color:var(--error, #e74c3c);font-size:.8rem;margin-top:.25rem;display:block}.auth-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1.25rem;width:100%}.auth-actions.centered[_ngcontent-%COMP%]{justify-content:center}.btn-cancel[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{flex:1;padding:.6rem 1rem;border-radius:8px;font-size:.95rem;font-weight:600;cursor:pointer;text-align:center;text-decoration:none;display:inline-flex;align-items:center;justify-content:center}.btn-cancel[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{background:transparent;color:var(--text-secondary);border:1px solid var(--border-color)}.btn-submit[_ngcontent-%COMP%]{background:var(--color-primary);color:var(--background-dark);border:none;font-weight:800;text-transform:uppercase;letter-spacing:.05em;box-shadow:var(--shadow-neon)}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){filter:brightness(1.1);box-shadow:0 0 20px color-mix(in srgb,var(--color-primary) 40%,transparent);transform:translateY(-2px)}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}"]})};export{j as ResetPasswordComponent};
