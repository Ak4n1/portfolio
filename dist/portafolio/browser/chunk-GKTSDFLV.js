import{a as E}from"./chunk-QAUAQUX7.js";import{c as k,d as l,e as R,f as N,k as T,m as z,n as D,v as q,x as A}from"./chunk-IGSUT72Y.js";import{c as I}from"./chunk-4ZIDF6L4.js";import"./chunk-MQB6D6E4.js";import{f as F,g as S}from"./chunk-IBUNDTLB.js";import"./chunk-46EHWJZL.js";import"./chunk-AB3PYKT6.js";import{k as v,s as b}from"./chunk-L3SKP5V6.js";import{Ab as d,Ib as u,Jb as M,Rb as s,Sb as O,Ua as i,Za as y,_ as f,cb as h,hb as p,ob as C,pb as m,ra as x,rb as c,sb as _,t as P,yb as o,zb as r}from"./chunk-GWDYAHF2.js";function B(a,e){a&1&&(o(0,"span",29),s(1,"M\xEDnimo 2 caracteres"),r())}function H(a,e){a&1&&(o(0,"span",29),s(1,"M\xEDnimo 2 caracteres"),r())}function J(a,e){a&1&&(o(0,"span",29),s(1,"Email v\xE1lido requerido"),r())}function K(a,e){a&1&&(o(0,"span",29),s(1,"M\xEDnimo 6 caracteres"),r())}function Q(a,e){a&1&&(o(0,"span",29),s(1,"Las contrase\xF1as no coinciden"),r())}var w=class a{constructor(e){this.fb=e;this.form=this.fb.group({name:["",[l.required,l.minLength(2)]],apellido:["",[l.required,l.minLength(2)]],email:["",[l.required,l.email]],password:["",[l.required,l.minLength(6)]],confirmPassword:["",[l.required]]},{validators:this.passwordMatchValidator})}submitForm=x();form;passwordMatchValidator(e){let n=e.get("password")?.value,t=e.get("confirmPassword")?.value;return n===t?null:{mismatch:!0}}isFieldInvalid(e){let n=this.form.get(e);return!!n&&n.invalid&&(n.dirty||n.touched)}isConfirmPasswordInvalid(){let e=this.form.get("confirmPassword");return!!e&&this.form.hasError("mismatch")&&(e?.dirty||e?.touched)}showPassword=!1;showConfirmPassword=!1;togglePassword(){this.showPassword=!this.showPassword}toggleConfirmPassword(){this.showConfirmPassword=!this.showConfirmPassword}onSubmit(){if(this.form.valid){let{name:e,apellido:n,email:t,password:g}=this.form.value;this.submitForm.emit({name:e,apellido:n,email:t,password:g})}else Object.keys(this.form.controls).forEach(e=>this.form.get(e)?.markAsTouched())}static \u0275fac=function(n){return new(n||a)(y(q))};static \u0275cmp=h({type:a,selectors:[["app-register-form"]],outputs:{submitForm:"submitForm"},decls:51,vars:25,consts:[[1,"auth-form"],[1,"auth-title"],[1,"auth-subtitle"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group"],["for","register-name"],[1,"input-with-icon"],[1,"fas","fa-user","input-icon"],["id","register-name","type","text","formControlName","name","placeholder","Tu nombre"],["class","error-msg",4,"ngIf"],["for","register-apellido"],[1,"fas","fa-user-tag","input-icon"],["id","register-apellido","type","text","formControlName","apellido","placeholder","Tu apellido"],["for","register-email"],[1,"fas","fa-envelope","input-icon"],["id","register-email","type","email","formControlName","email","placeholder","tu@email.com"],["for","register-password"],[1,"password-input-wrapper","input-with-icon"],[1,"fas","fa-lock","input-icon"],["id","register-password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"password-input-field",3,"type"],["type","button",1,"password-toggle",3,"click"],["aria-hidden","true"],["for","register-confirm"],[1,"fas","fa-shield-halved","input-icon"],["id","register-confirm","formControlName","confirmPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"password-input-field",3,"type"],[1,"auth-actions"],["routerLink","/login",1,"btn-cancel"],["type","submit",1,"btn-submit",3,"disabled"],[1,"error-msg"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"h2",1),s(2,"Registrarse"),r(),o(3,"p",2),s(4,"Completa el formulario para registrarte"),r(),o(5,"form",3),u("ngSubmit",function(){return t.onSubmit()}),o(6,"div",4)(7,"div",5)(8,"label",6),s(9,"Nombre"),r(),o(10,"div",7),d(11,"i",8)(12,"input",9),r(),p(13,B,2,0,"span",10),r(),o(14,"div",5)(15,"label",11),s(16,"Apellido"),r(),o(17,"div",7),d(18,"i",12)(19,"input",13),r(),p(20,H,2,0,"span",10),r()(),o(21,"div",5)(22,"label",14),s(23,"Email"),r(),o(24,"div",7),d(25,"i",15)(26,"input",16),r(),p(27,J,2,0,"span",10),r(),o(28,"div",5)(29,"label",17),s(30,"Contrase\xF1a"),r(),o(31,"div",18),d(32,"i",19)(33,"input",20),o(34,"button",21),u("click",function(){return t.togglePassword()}),d(35,"i",22),r()(),p(36,K,2,0,"span",10),r(),o(37,"div",5)(38,"label",23),s(39,"Confirmar contrase\xF1a"),r(),o(40,"div",18),d(41,"i",24)(42,"input",25),o(43,"button",21),u("click",function(){return t.toggleConfirmPassword()}),d(44,"i",22),r()(),p(45,Q,2,0,"span",10),r(),o(46,"div",26)(47,"a",27),s(48,"Ya tengo cuenta"),r(),o(49,"button",28),s(50,"Registrarse"),r()()()()),n&2&&(i(5),m("formGroup",t.form),i(7),c("error",t.isFieldInvalid("name")),i(),m("ngIf",t.isFieldInvalid("name")),i(6),c("error",t.isFieldInvalid("apellido")),i(),m("ngIf",t.isFieldInvalid("apellido")),i(6),c("error",t.isFieldInvalid("email")),i(),m("ngIf",t.isFieldInvalid("email")),i(6),c("error",t.isFieldInvalid("password")),m("type",t.showPassword?"text":"password"),i(),C("aria-label",t.showPassword?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),i(),_(t.showPassword?"fas fa-eye":"fas fa-eye-slash"),i(),m("ngIf",t.isFieldInvalid("password")),i(6),c("error",t.isConfirmPasswordInvalid()),m("type",t.showConfirmPassword?"text":"password"),i(),C("aria-label",t.showConfirmPassword?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),i(),_(t.showConfirmPassword?"fas fa-eye":"fas fa-eye-slash"),i(),m("ngIf",t.isConfirmPasswordInvalid()),i(4),m("disabled",t.form.invalid))},dependencies:[A,T,k,R,N,z,D,b,v,S],styles:[".auth-form[_ngcontent-%COMP%]{padding:.5rem}.auth-title[_ngcontent-%COMP%]{color:var(--color-primary);font-size:1.75rem;font-weight:700;margin-bottom:.5rem;text-align:center}.auth-subtitle[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:.8125rem;text-transform:uppercase;letter-spacing:.05em;text-align:center;margin-bottom:2rem}.form-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem;width:100%}@media (max-width: 767px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;color:var(--color-text-secondary);font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;margin-bottom:.5rem;margin-left:.25rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem .875rem 2.75rem;background:color-mix(in srgb,var(--color-text-primary) 8%,transparent);border:1px solid color-mix(in srgb,var(--color-text-primary) 25%,transparent);border-radius:var(--border-radius-md);color:var(--color-text-primary);font-size:1rem;transition:border-color .2s,box-shadow .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--color-text-secondary);opacity:.5}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 2px color-mix(in srgb,var(--color-primary) 25%,transparent)}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:var(--error)}.input-with-icon[_ngcontent-%COMP%]{position:relative;width:100%}.input-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--color-text-secondary);font-size:1rem;pointer-events:none;z-index:2;transition:color .2s ease}.password-input-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.password-input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{left:1rem}.password-input-field[_ngcontent-%COMP%]{padding-right:3rem;width:100%}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:.75rem;top:50%;transform:translateY(-50%);background:transparent;border:none;cursor:pointer;padding:.5rem;display:flex;align-items:center;justify-content:center;color:var(--text-secondary);transition:color .2s ease;min-width:32px;min-height:32px;z-index:1}.password-toggle[_ngcontent-%COMP%]:hover{color:var(--color-primary)}.password-toggle[_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--primary-color);outline-offset:2px}.password-toggle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.125rem;color:currentColor}.error-msg[_ngcontent-%COMP%]{color:var(--error);font-size:.8rem;margin-top:.25rem;display:block}.auth-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1.25rem}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{flex:1;padding:.6rem 1rem;border-radius:8px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s;text-decoration:none;text-align:center;display:inline-flex;align-items:center;justify-content:center}.btn-cancel[_ngcontent-%COMP%]{background:transparent;color:var(--text-secondary);border:1px solid var(--border-color)}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--background-card);color:var(--text-primary);border-color:var(--border-hover)}.btn-submit[_ngcontent-%COMP%]{background:var(--color-primary);color:var(--background-dark);border:none;font-weight:800;text-transform:uppercase;letter-spacing:.05em;box-shadow:var(--shadow-neon)}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){filter:brightness(1.1);box-shadow:0 0 20px color-mix(in srgb,var(--color-primary) 40%,transparent);transform:translateY(-2px)}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed;box-shadow:none}"]})};function U(a,e){if(a&1&&(o(0,"p",4),s(1),r()),a&2){let n=M();i(),O(n.serverError)}}var G=class a{router=f(F);authService=f(E);authStateService=f(I);serverError="";ngOnInit(){if(this.authStateService.value.isAuthenticated){this.router.navigate(["/home"]);return}P(this.authService.refreshToken()).then(e=>{e?.user&&(this.authStateService.setAuthenticated(e.user),this.router.navigate(["/home"]))}).catch(()=>{})}onSubmit(e){this.serverError="",this.authService.register({email:e.email,password:e.password,firstName:e.name,lastName:e.apellido}).subscribe({next:n=>this.router.navigate(["/verify-email-pending"],{queryParams:{email:n.user?.email||e.email}}),error:n=>{this.serverError=n.error?.message||"Error al registrarse. Intenta de nuevo."}})}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=h({type:a,selectors:[["app-register"]],decls:4,vars:1,consts:[[1,"auth-page"],[1,"auth-container"],["class","auth-error",4,"ngIf"],[3,"submitForm"],[1,"auth-error"]],template:function(n,t){n&1&&(o(0,"section",0)(1,"div",1),p(2,U,2,1,"p",2),o(3,"app-register-form",3),u("submitForm",function(j){return t.onSubmit(j)}),r()()()),n&2&&(i(2),m("ngIf",t.serverError))},dependencies:[b,v,w],styles:[".auth-page[_ngcontent-%COMP%]{min-height:80vh;display:flex;align-items:center;justify-content:center;padding:2rem}.auth-error[_ngcontent-%COMP%]{color:var(--error, #e74c3c);font-size:.9rem;margin-bottom:1rem;text-align:center}.auth-container[_ngcontent-%COMP%]{width:100%;max-width:480px;background:color-mix(in srgb,var(--color-primary) 6%,var(--background-dark));-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid color-mix(in srgb,var(--color-primary) 12%,transparent);border-radius:.75rem;padding:2.5rem;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:var(--shadow-card)}.auth-container[_ngcontent-%COMP%]:hover{transform:translateY(-4px);border-color:var(--color-primary);box-shadow:var(--shadow-neon)}"]})};export{G as RegisterComponent};
