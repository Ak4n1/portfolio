import{b as d}from"./chunk-B7NS5OZX.js";import{U as h,_ as c,a as s,b as r,f as n,la as l,m as u,oc as S,t as o}from"./chunk-GWDYAHF2.js";var f=class a{injector=c(l);initialized=!1;initialState={isAuthenticated:!1,user:null,isLoading:!0};authStateSubject=new u(this.initialState);authState=this.authStateSubject.asObservable();userStateSignal=d(this.authState,{initialValue:this.initialState});currentUser=S(()=>this.userStateSignal().user);constructor(){this.initializeAuthState()}initializeAuthState(){return n(this,null,function*(){if(!this.initialized){this.initialized=!0,this.setLoading(!0);try{let{AuthService:t}=yield import("./chunk-G3S6K42Q.js"),e=this.injector.get(t),i=yield o(e.refreshToken());i?.user?this.setAuthenticated(i.user):this.clearState()}catch{this.clearState()}finally{this.setLoading(!1)}}})}setAuthenticated(t){this.authStateSubject.next({isAuthenticated:!0,user:t,isLoading:!1})}setLoggedOut(){this.clearState()}setLoading(t){this.authStateSubject.next(r(s({},this.authStateSubject.value),{isLoading:t}))}clearState(){this.authStateSubject.next(r(s({},this.initialState),{isLoading:!1}))}refreshUserState(){return n(this,null,function*(){if(this.value.isAuthenticated)try{let{AuthService:t}=yield import("./chunk-G3S6K42Q.js"),e=this.injector.get(t),i=yield o(e.refreshToken());i?.user&&this.setAuthenticated(i.user)}catch{this.clearState()}})}get value(){return this.authStateSubject.value}static \u0275fac=function(e){return new(e||a)};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};export{f as a};
